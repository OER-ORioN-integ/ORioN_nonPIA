{
  "name" : "orion_prd_etl-job_datalink_past_octpass_single_item_detail",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::142980225941:role/orion_prd_glue-role",
  "executionProperty" : {
    "maxConcurrentRuns" : 100
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://orion-prd-etljob/scripts/orion_prd_etl-job_datalink_past_octpass_single_item_detail.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--FILE_NAME" : "octpass_single_item_detail_dwh_20250109090000.snappy.parquet",
    "--enable-metrics" : "true",
    "--spark-event-logs-path" : "s3://orion-prd-etljob/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--EXECUTE_TIMESTAMP_ISO_STR" : "2025-01-15T04:45:00.000Z",
    "--SOURCE_SYSTEM" : "OCTPASS",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--DATA_NAME" : "past_octpass_single_item_detail",
    "--job-language" : "python",
    "--TempDir" : "s3://orion-prd-etljob/tmp/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 4,
  "timeout" : 120,
  "maxCapacity" : 4.0,
  "glueVersion" : "4.0",
  "numberOfWorkers" : 2,
  "workerType" : "G.2X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1735281843676\":{\"CustomCode\":{\"ClassName\":\"MyTransform_combine_corner_code\",\"Code\":\"from pyspark.sql.functions import col, concat\\nfrom awsglue.dynamicframe import DynamicFrame\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# 入力カラム名のリスト\\ninput_columns_list = [\\n    (\\\"this_oer_enty_orion_sta_code\\\", \\\"this_oer_enty_gate\\\"),\\n    (\\\"this_oer_exit_orion_sta_code\\\", \\\"this_oer_exit_gate\\\"),\\n]\\n    \\n# 出力カラム名のリスト\\noutput_columns_list = [\\n    \\\"this_oer_enty_gate\\\",\\\"this_oer_exit_gate\\\",\\n\\n]\\n\\n# 各カラムセットに対して結合と新しいカラムの追加\\nfor input_columns, output_column in zip(input_columns_list, output_columns_list):\\n    df = df.withColumn(output_column, concat(col(input_columns[0]), col(input_columns[1])))\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)    \",\"Inputs\":[\"node-1735115459130\"],\"Name\":\"【加工】コーナーコード（生成）\"}},\"node-1735115459130\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735115376657\"],\"Name\":\"【加工後必須】今回駅名設定\"}},\"node-1730279185825\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1730279130441\"],\"Name\":\"【加工時必須】加工後処理（項目順序の並替え）\"}},\"node-1735116222860\":{\"CustomCode\":{\"ClassName\":\"MyTransform_Delete_column_name\",\"Code\":\"from awsglue.dynamicframe import DynamicFrame\\nfrom pyspark.sql.functions import col\\n\\n### 作成時の修正箇所ここから ###\\n# 削除項目名の設定\\n削除項目名リスト = [\\n    \\\"this_bef_enty_orion_sta_code\\\",\\\"this_bef_exit_orion_sta_code\\\",\\\"this_oer_enty_orion_sta_code\\\",\\\"this_oer_enty_gate\\\",\\\"this_oer_exit_orion_sta_code\\\",\\\"this_oer_exit_gate\\\",\\\"this_after_enty_orion_sta_code\\\",\\\"orig_tick_oer1_sta_orion_sta_code\\\",\\\"orig_tick_oer1_end_orion_sta_code\\\",\\\"orig_tick_oer1_via1_orion_sta_code\\\",\\\"orig_tick_oer1_via2_orion_sta_code\\\",\\\"orig_tick_oer1_via3_orion_sta_code\\\",\\\"orig_tick_oer1_via4_orion_sta_code\\\",\\\"orig_tick_oer1_via5_orion_sta_code\\\",\\\"orig_tick_oer1_via6_orion_sta_code\\\",\\\"orig_tick_oer1_via7_orion_sta_code\\\",\\\"orig_tick_oer1_via8_orion_sta_code\\\",\\\"orig_tick_oer1_via9_orion_sta_code\\\",\\\"orig_tick_oer1_via10_orion_sta_code\\\",\\\"orig_tick_oer1_free_orion_sta_code\\\",\\n        ]\\n### 作成時の修正箇所ここまで ###\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# 不要なカラムを削除\\nfor 削除項目名 in 削除項目名リスト:\\n    df = df.drop(col(削除項目名))\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1735115510868\"],\"Name\":\"【加工】非連携項目の削除\"}},\"node-1733302891155\":{\"CustomCode\":{\"ClassName\":\"MyTransform_uehara_od\",\"Code\":\"from pyspark.sql.functions import col, when\\nfrom awsglue.dynamicframe import DynamicFrame\\n\\n### 作成時の修正箇所ここから ###\\n# 入力項目名と出力項目名の設定\\nA入力項目名リスト = [\\\"this_oer_enty_od_sta_code\\\", \\\"this_oer_exit_od_sta_code\\\"]\\nB入力項目名リスト = [\\\"this_oer_enty_gate\\\", \\\"this_oer_exit_gate\\\"]\\n### 作成時の修正箇所ここまで ###\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# A入力項目が50の場合かつB入力項目が空白の場合にA入力項目値を\\\"53\\\"に上書き\\nif A入力項目名リスト is not None:\\n    for A入力項目名, B入力項目名 in zip(A入力項目名リスト, B入力項目名リスト):\\n        if A入力項目名:  # A入力項目名が空白でない場合に処理を行う\\n            df = df.withColumn(A入力項目名, \\n                               when((col(A入力項目名) == \\\"50\\\") & (col(B入力項目名) == \\\"\\\"), \\\"53\\\")\\n                               .otherwise(col(A入力項目名)))\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1733302305630\"],\"Name\":\"【加工】上原直通OD変更\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"seq_no\",\"Type\":\"string\"},{\"Name\":\"data\",\"Type\":\"string\"},{\"Name\":\"Judgment\",\"Type\":\"string\"},{\"Name\":\"Judgment_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_bef_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_usage\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_usage\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_after_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_after_usage\",\"Type\":\"string\"},{\"Name\":\"deduction\",\"Type\":\"int\"},{\"Name\":\"orig_tick_bef_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_2nd_section\",\"Type\":\"string\"},{\"Name\":\"correction_fg\",\"Type\":\"string\"},{\"Name\":\"ictype\",\"Type\":\"string\"},{\"Name\":\"mobile_fg\",\"Type\":\"string\"},{\"Name\":\"is_valid_sub_pass\",\"Type\":\"string\"},{\"Name\":\"is_oerpass\",\"Type\":\"string\"},{\"Name\":\"orion_process_datetm\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"area_code\",\"Type\":\"string\"},{\"Name\":\"line\",\"Type\":\"string\"},{\"Name\":\"sta_ord\",\"Type\":\"string\"},{\"Name\":\"comp\",\"Type\":\"string\"},{\"Name\":\"route name\",\"Type\":\"string\"},{\"Name\":\"sta_name\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_od_sta_code\",\"Type\":\"string\"}]}]}},\"node-1735115510868\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735115478379\"],\"Name\":\"【加工後必須】今回DM券種設定\"}},\"node-1735115042302\":{\"CustomCode\":{\"ClassName\":\"MyTransform_station_name\",\"Code\":\"from pyspark.sql.functions import col, lit, when\\nfrom awsglue.dynamicframe import DynamicFrame\\nimport boto3\\nimport pyarrow.parquet as pq\\nimport s3fs\\nfrom pyspark.sql import SparkSession\\nfrom pyspark.sql.functions import broadcast\\n\\n# S3パスとマスターデータの設定\\ns3_path = \\\"s3://orion-prd-dwh/MANUAL/stations_master/latest/\\\"\\nmaster_file_prefix = \\\"stations_master_dwh_\\\"\\nmaster_key = \\\"orion_sta_code\\\"\\nmaster_value = \\\"sta_name\\\"\\n\\n# ORioN駅コードから駅名を設定する。\\n# \\n# 入力項目名リストの設定\\ninput_column_list = [\\n    \\\"this_bef_enty_orion_sta_code\\\",\\\"this_bef_exit_orion_sta_code\\\",\\\"this_after_enty_orion_sta_code\\\",\\\"orig_tick_oer1_sta_orion_sta_code\\\",\\\"orig_tick_oer1_end_orion_sta_code\\\",\\\"orig_tick_oer1_via1_orion_sta_code\\\",\\\"orig_tick_oer1_via2_orion_sta_code\\\",\\\"orig_tick_oer1_via3_orion_sta_code\\\",\\\"orig_tick_oer1_via4_orion_sta_code\\\",\\\"orig_tick_oer1_via5_orion_sta_code\\\",\\\"orig_tick_oer1_via6_orion_sta_code\\\",\\\"orig_tick_oer1_via7_orion_sta_code\\\",\\\"orig_tick_oer1_via8_orion_sta_code\\\",\\\"orig_tick_oer1_via9_orion_sta_code\\\",\\\"orig_tick_oer1_via10_orion_sta_code\\\",\\\"orig_tick_oer1_free_orion_sta_code\\\",\\n    ]\\noutput_column_list = [\\n    \\\"this_bef_enty_sta_name\\\",\\\"this_bef_exit_sta_name\\\",\\\"this_after_enty_sta_name\\\",\\\"orig_tick_oer1_sta_sta_name\\\",\\\"orig_tick_oer1_end_sta_name\\\",\\\"orig_tick_oer1_via1_sta_name\\\",\\\"orig_tick_oer1_via2_sta_name\\\",\\\"orig_tick_oer1_via3_sta_name\\\",\\\"orig_tick_oer1_via4_sta_name\\\",\\\"orig_tick_oer1_via5_sta_name\\\",\\\"orig_tick_oer1_via6_sta_name\\\",\\\"orig_tick_oer1_via7_sta_name\\\",\\\"orig_tick_oer1_via8_sta_name\\\",\\\"orig_tick_oer1_via9_sta_name\\\",\\\"orig_tick_oer1_via10_sta_name\\\",\\\"orig_tick_oer1_free_sta_name\\\",\\n    ]\\n\\n# S3からマスターデータを読み込む\\ns3 = s3fs.S3FileSystem()\\nfiles = s3.glob(s3_path + master_file_prefix + \\\"*.parquet\\\")\\nmaster_df = None\\nfor file in files:\\n    with s3.open(file, 'rb') as f:\\n        if master_df is None:\\n            master_df = pq.read_table(f).to_pandas()\\n        else:\\n            master_df = master_df.append(pq.read_table(f).to_pandas())\\n\\n# Spark DataFrameに変換\\nspark = SparkSession.builder.getOrCreate()\\nmaster_spark_df = spark.createDataFrame(master_df)\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# orion_process_datetm 列を保持するためのバックアップ\\ndf = df.withColumn(\\\"orion_process_datetm_backup\\\", col(\\\"orion_process_datetm\\\"))\\n\\n# 入力項目名リストの処理\\nfor i, input_col in enumerate(input_column_list):\\n    output_col = output_column_list[i]\\n    df = df.alias(\\\"df\\\").join(broadcast(master_spark_df.alias(\\\"master\\\")), col(f\\\"df.{input_col}\\\") == col(f\\\"master.{master_key}\\\"), \\\"left_outer\\\") \\\\\\n           .withColumn(output_col, when(col(f\\\"master.{master_value}\\\").isNotNull(), col(f\\\"master.{master_value}\\\")).otherwise(lit(\\\"\\\"))) \\\\\\n           .drop(col(f\\\"master.{master_key}\\\")) \\\\\\n           .drop(col(f\\\"master.{master_value}\\\"))\\n\\n# orion_process_datetm 列を元に戻す\\ndf = df.withColumn(\\\"orion_process_datetm\\\", col(\\\"orion_process_datetm_backup\\\")).drop(\\\"orion_process_datetm_backup\\\")\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1733302977291\"],\"Name\":\"【加工】駅名設定\"}},\"node-1735116308358\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735116222860\"],\"Name\":\"【加工済必須】非連携項目の削除\"}},\"node-1735116384834\":{\"CustomCode\":{\"ClassName\":\"MyTransformSortFeilds_name\",\"Code\":\"from awsglue.dynamicframe import DynamicFrame, DynamicFrameCollection\\n\\n### 作成時の修正箇所ここから ###\\n# 並び替えたい順序で全項目名を記載する\\n項目順序 = [\\n    \\\"seq_no\\\",\\\"data\\\",\\\"judgment\\\",\\\"judgment_code\\\",\\\"this_bef_enty_sta_name\\\",\\\"this_bef_enty_date\\\",\\\"this_bef_enty_time\\\",\\\"this_bef_exit_sta_name\\\",\\\"this_bef_exit_date\\\",\\\"this_bef_exit_time\\\",\\\"this_bef_usage\\\",\\\"this_oer_enty_sta_name\\\",\\\"this_oer_enty_od_sta_code\\\",\\\"this_oer_enty_gate_name\\\",\\\"this_oer_enty_gate_no\\\",\\\"this_oer_enty_date\\\",\\\"this_oer_enty_time\\\",\\\"this_oer_exit_sta_name\\\",\\\"this_oer_exit_od_sta_code\\\",\\\"this_oer_exit_gate_name\\\",\\\"this_oer_exit_gate_no\\\",\\\"this_oer_exit_date\\\",\\\"this_oer_exit_time\\\",\\\"this_oer_usage\\\",\\\"this_oer_dm_ticket_type\\\",\\\"this_after_enty_sta_name\\\",\\\"this_after_enty_date\\\",\\\"this_after_enty_time\\\",\\\"this_after_usage\\\",\\\"deduction\\\",\\\"orig_tick_oer1_ticket_type\\\",\\\"orig_tick_oer1_idi\\\",\\\"orig_tick_oer1_child_fg\\\",\\\"orig_tick_oer1_u_code\\\",\\\"orig_tick_oer1_age\\\",\\\"orig_tick_oer1_sex\\\",\\\"orig_tick_oer1_charge_fg\\\",\\\"orig_tick_oer1_inbound\\\",\\\"orig_tick_oer1_sta_date\\\",\\\"orig_tick_oer1_end_date\\\",\\\"orig_tick_oer1_sta_sta_name\\\",\\\"orig_tick_oer1_sta_station_w_no\\\",\\\"orig_tick_oer1_end_sta_name\\\",\\\"orig_tick_oer1_end_station_w_no\\\",\\\"orig_tick_oer1_via1_sta_name\\\",\\\"orig_tick_oer1_via2_sta_name\\\",\\\"orig_tick_oer1_via3_sta_name\\\",\\\"orig_tick_oer1_via4_sta_name\\\",\\\"orig_tick_oer1_via5_sta_name\\\",\\\"orig_tick_oer1_via6_sta_name\\\",\\\"orig_tick_oer1_via7_sta_name\\\",\\\"orig_tick_oer1_via8_sta_name\\\",\\\"orig_tick_oer1_via9_sta_name\\\",\\\"orig_tick_oer1_via10_sta_name\\\",\\\"orig_tick_oer1_free_sta_name\\\",\\\"orig_tick_oer1_com_school\\\",\\\"orig_tick_oer1_discount\\\",\\\"orig_tick_oer1_2nd_section\\\",\\\"correction_fg\\\",\\\"ictype\\\",\\\"mobile_fg\\\",\\\"is_valid_sub_pass\\\",\\\"is_oerpass\\\",\\\"orion_process_datetm\\\",\\n    ]\\n### 作成時の修正箇所ここまで ###\\n\\n# DataFrameの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# 指定した順序でDataFrameのカラムを並び替え\\ndf = df.select(項目順序)\\n\\n# DynamicFrameに変換して返す\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1735116308358\"],\"Name\":\"【加工】項目順序の並替え（駅名）\"}},\"node-1733378697414\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1733378552816\"],\"Name\":\"【加工済必須】非連携項目の削除\"}},\"node-1736917015955\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1736915757100\"],\"Name\":\"【加工済必須】連携された匿名化済みデータの読み込み\"}},\"node-1733302305630\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1733302184125\"],\"Name\":\"【加工後必須】OD駅マスタ設定\"}},\"node-1735281571512\":{\"CustomCode\":{\"ClassName\":\"MyTransform_station_gate\",\"Code\":\"from pyspark.sql.functions import col, lit, when\\nfrom awsglue.dynamicframe import DynamicFrame\\nimport boto3\\nimport pyarrow.parquet as pq\\nimport s3fs\\nfrom pyspark.sql import SparkSession\\nfrom pyspark.sql.functions import broadcast\\n\\n# S3パスとマスターデータの設定\\ns3_path = \\\"s3://orion-prd-dwh/MANUAL/gate_master/latest/\\\"\\nmaster_file_prefix = \\\"gate_master_dwh_\\\"\\nmaster_key = \\\"corner_code_gen\\\"\\nmaster_value = \\\"corner_name\\\"\\n\\n# ORioN駅コードから駅名を設定する。\\n# \\n# 入力項目名リストの設定\\ninput_column_list = [\\n    \\\"this_oer_enty_gate\\\",\\\"this_oer_exit_gate\\\",\\n    ]\\noutput_column_list = [\\n    \\\"this_oer_enty_gate_name\\\",\\\"this_oer_exit_gate_name\\\",\\n    ]\\n\\n# S3からマスターデータを読み込む\\ns3 = s3fs.S3FileSystem()\\nfiles = s3.glob(s3_path + master_file_prefix + \\\"*.parquet\\\")\\nmaster_df = None\\nfor file in files:\\n    with s3.open(file, 'rb') as f:\\n        if master_df is None:\\n            master_df = pq.read_table(f).to_pandas()\\n        else:\\n            master_df = master_df.append(pq.read_table(f).to_pandas())\\n\\n# Spark DataFrameに変換\\nspark = SparkSession.builder.getOrCreate()\\nmaster_spark_df = spark.createDataFrame(master_df)\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# orion_process_datetm 列を保持するためのバックアップ\\ndf = df.withColumn(\\\"orion_process_datetm_backup\\\", col(\\\"orion_process_datetm\\\"))\\n\\n# 入力項目名リストの処理\\nfor i, input_col in enumerate(input_column_list):\\n    output_col = output_column_list[i]\\n    df = df.alias(\\\"df\\\").join(broadcast(master_spark_df.alias(\\\"master\\\")), col(f\\\"df.{input_col}\\\") == col(f\\\"master.{master_key}\\\"), \\\"left_outer\\\") \\\\\\n           .withColumn(output_col, when(col(f\\\"master.{master_value}\\\").isNotNull(), col(f\\\"master.{master_value}\\\")).otherwise(lit(\\\"\\\"))) \\\\\\n           .drop(col(f\\\"master.{master_key}\\\")) \\\\\\n           .drop(col(f\\\"master.{master_value}\\\"))\\n\\n# orion_process_datetm 列を元に戻す\\ndf = df.withColumn(\\\"orion_process_datetm\\\", col(\\\"orion_process_datetm_backup\\\")).drop(\\\"orion_process_datetm_backup\\\")\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\",\"Inputs\":[\"node-1735282090189\"],\"Name\":\"【加工】コーナー名\"}},\"node-1733302184125\":{\"CustomCode\":{\"ClassName\":\"MyTransform_od_station_cd\",\"Code\":\"from pyspark.sql.functions import col, lit, when\\nfrom awsglue.dynamicframe import DynamicFrame\\nimport boto3\\nimport pyarrow.parquet as pq\\nimport s3fs\\nfrom pyspark.sql import SparkSession\\nfrom pyspark.sql.functions import broadcast\\n\\n# S3パスとマスターデータの設定\\ns3_path = \\\"s3://orion-prd-dwh/MANUAL/stations_master/latest/\\\"\\nmaster_file_prefix = \\\"stations_master_dwh_\\\"\\nmaster_key = \\\"orion_sta_code\\\"\\nmaster_value = \\\"od_mst_sta_code\\\"\\n\\n# 入力項目名リストの設定\\ninput_column_list = [\\n    \\\"this_oer_enty_orion_sta_code\\\",\\\"this_oer_exit_orion_sta_code\\\",\\n    ]\\noutput_column_list = [\\n    \\\"this_oer_enty_od_sta_code\\\",\\\"this_oer_exit_od_sta_code\\\",\\n    ]\\n\\n# S3からマスターデータを読み込む\\ns3 = s3fs.S3FileSystem()\\nfiles = s3.glob(s3_path + master_file_prefix + \\\"*.parquet\\\")\\nmaster_df = None\\nfor file in files:\\n    with s3.open(file, 'rb') as f:\\n        if master_df is None:\\n            master_df = pq.read_table(f).to_pandas()\\n        else:\\n            master_df = master_df.append(pq.read_table(f).to_pandas())\\n\\n# Spark DataFrameに変換\\nspark = SparkSession.builder.getOrCreate()\\nmaster_spark_df = spark.createDataFrame(master_df)\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# orion_process_datetm 列を保持するためのバックアップ\\ndf = df.withColumn(\\\"orion_process_datetm_backup\\\", col(\\\"orion_process_datetm\\\"))\\n\\n# 入力項目名リストの処理\\nfor i, input_col in enumerate(input_column_list):\\n    output_col = output_column_list[i]\\n    df = df.join(broadcast(master_spark_df), df[input_col] == master_spark_df[master_key], \\\"left_outer\\\") \\\\\\n           .withColumn(output_col, when(col(master_value).isNotNull(), col(master_value)).otherwise(lit(\\\"\\\"))) \\\\\\n           .drop(master_key, master_value)\\n\\n# orion_process_datetm 列を元に戻す\\ndf = df.withColumn(\\\"orion_process_datetm\\\", col(\\\"orion_process_datetm_backup\\\")).drop(\\\"orion_process_datetm_backup\\\")\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1733378697414\"],\"Name\":\"【加工】OD駅マスタ設定\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"seq_no\",\"Type\":\"string\"},{\"Name\":\"data\",\"Type\":\"string\"},{\"Name\":\"Judgment\",\"Type\":\"string\"},{\"Name\":\"Judgment_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_bef_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_usage\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_usage\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_after_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_after_usage\",\"Type\":\"string\"},{\"Name\":\"deduction\",\"Type\":\"int\"},{\"Name\":\"orig_tick_bef_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_2nd_section\",\"Type\":\"string\"},{\"Name\":\"correction_fg\",\"Type\":\"string\"},{\"Name\":\"ictype\",\"Type\":\"string\"},{\"Name\":\"mobile_fg\",\"Type\":\"string\"},{\"Name\":\"is_valid_sub_pass\",\"Type\":\"string\"},{\"Name\":\"is_oerpass\",\"Type\":\"string\"},{\"Name\":\"orion_process_datetm\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"area_code\",\"Type\":\"string\"},{\"Name\":\"line\",\"Type\":\"string\"},{\"Name\":\"sta_ord\",\"Type\":\"string\"},{\"Name\":\"comp\",\"Type\":\"string\"},{\"Name\":\"route name\",\"Type\":\"string\"},{\"Name\":\"sta_name\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_od_sta_code\",\"Type\":\"string\"}]}]}},\"node-1728638294884\":{\"CustomCode\":{\"ClassName\":\"MyTransformOutputOneFileCsv\",\"Code\":\"from datetime import datetime, timedelta, timezone\\nimport boto3\\nfrom awsglue.utils import getResolvedOptions\\nfrom pyspark.sql import DataFrame\\n\\n### 作成時の修正箇所ここから ###\\n#  本ノードは作成時のパラメータ設定不要です。このままお使いください。\\n### 作成時の修正箇所ここまで ###\\n\\n# 関数定義\\ndef get_process_timestamp_from_df(df: DataFrame, column_name: str) -> str:\\n    \\\"\\\"\\\"DFからデータ統合基盤処理日時 文字列を取得する\\n    Args:\\n        df (pysoar.sql.DataFrame): データフレーム\\n        column_name (str): データ統合基盤処理日時項目名\\n    Returns:\\n        str: yyyymmddhhmmss\\n    \\\"\\\"\\\"\\n    # JSTタイムスタンプカラムの値を取得（yyyy/mm/dd hh:mm:ss形式）\\n    orion_process_datetm = df.select(column_name).first()[0]\\n    # yyyymmddhhmmss形式に変換\\n    res_datetm_str = datetime.strptime(orion_process_datetm, \\\"%Y/%m/%d %H:%M:%S\\\").strftime(\\\"%Y%m%d%H%M%S\\\")\\n    return res_datetm_str\\n\\ndef convert_timestamp_iso_to_jst(iso_time_str: str, output_format: str) -> str:\\n    \\\"\\\"\\\"ISO日時文字列を指定フォーマットに変換\\n    Args:\\n        iso_time_str (str): ISO日時文字列\\n        output_format (str): 出力フォーマット\\n    Returns:\\n        str: 指定フォーマット形式文字列\\n    \\\"\\\"\\\"\\n    # UTCの日時文字列をパースしてdatetimeオブジェクトに変換\\n    utc_time = datetime.strptime(iso_time_str, \\\"%Y-%m-%dT%H:%M:%S.%fZ\\\")\\n    # JSTへの変換（UTC+9時間）\\n    jst_time = utc_time.replace(tzinfo=timezone.utc).astimezone(timezone(timedelta(hours=9)))\\n    # フォーマット変換\\n    jst_time_str = jst_time.strftime(output_format)\\n    return jst_time_str\\n\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} INFO (MyTransformOutputOneFileParquet) start\\\")\\n\\n# Glueジョブ引数の取得\\nglue_params = getResolvedOptions(sys.argv, [\\\"SOURCE_SYSTEM\\\", \\\"DATA_NAME\\\", \\\"EXECUTE_TIMESTAMP_ISO_STR\\\"])\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (MyTransformOutputOneFileParquet) glue_params:{glue_params}\\\")\\n\\n# 連携元システム名（DMP/ONE/OCTPASS/MANUAL）\\nsource_system = glue_params.get(\\\"SOURCE_SYSTEM\\\", None)\\n# データ名（物理テーブル名）\\ndata_name = glue_params.get(\\\"DATA_NAME\\\", None)\\n# 実行日時\\nexecute_timestamp_iso_str = glue_params.get(\\\"EXECUTE_TIMESTAMP_ISO_STR\\\", None)\\n\\n# プレフィックスヘッド\\nprefix_head = f\\\"{source_system}/{data_name}\\\"\\n\\n# DataFrameの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# ■実行日時をJSTのyyyyymmddhhmmss文字列に変換\\n# DFの処理日時項目名\\nORION_PROCESS_DATETM = \\\"orion_process_datetm\\\"\\nif ORION_PROCESS_DATETM in df.columns and df.select(ORION_PROCESS_DATETM).count() != 0:\\n    execute_timestamp_str = get_process_timestamp_from_df(df=df, column_name=ORION_PROCESS_DATETM)\\n    print(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (get_process_timestamp_from_df) execute_timestamp_str:{execute_timestamp_str}\\\")\\nelse:\\n    execute_timestamp_str = convert_timestamp_iso_to_jst(iso_time_str=execute_timestamp_iso_str, output_format=\\\"%Y%m%d%H%M%S\\\")\\n    print(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (convert_timestamp_iso_to_jst) execute_timestamp_str:{execute_timestamp_str}\\\")\\n\\n# 作業用バケット\\nwork_bucket = \\\"orion-prd-work\\\"\\n# workディレクトリ\\nwork_dir = f\\\"{prefix_head}/dwh_work_{execute_timestamp_str}/\\\"\\n# 一時出力先s3パス\\nwork_s3_path = f\\\"s3://{work_bucket}/{work_dir}\\\"\\n\\n# workディレクトリにCSV形式で出力\\ndf.coalesce(1).write.options(encoding=\\\"UTF-8\\\", lineSep=\\\"\\\\n\\\", sep=\\\",\\\", quoteAll=True, header=True).mode(\\\"overwrite\\\").csv(work_s3_path)    \\n\\n# DM_Bdashバケット\\ndm_bdash_bucket = \\\"orion-prd-dm-bdash\\\"\\n# 連携先ディレクトリ\\noutput_prefix = f\\\"{source_system}/{data_name}\\\"\\n# 連携ファイル名\\nfile_name = f\\\"octpass_single_item_detail_{execute_timestamp_str}.csv\\\"\\n# 連携先key\\nfile_key = f\\\"{output_prefix}/{file_name}\\\"\\n\\n# S3クライアントを使用してworkフォルダに出力したファイルをリネームして移動\\ns3 = boto3.client(\\\"s3\\\")\\nresponse = s3.list_objects_v2(Bucket=work_bucket, Prefix=work_dir)\\nfor obj in response.get(\\\"Contents\\\", []):\\n    if obj[\\\"Key\\\"].endswith(\\\".csv\\\"):\\n        copy_source = {\\\"Bucket\\\": work_bucket, \\\"Key\\\": obj[\\\"Key\\\"]}\\n        print(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (MyTransformOutputOneFileCsv) copy_source:{copy_source}, dm_bdash_bucket:{dm_bdash_bucket}, file_key:{file_key}\\\")\\n        s3.copy_object(CopySource=copy_source, Bucket=dm_bdash_bucket, Key=file_key)\\n        s3.delete_object(Bucket=work_bucket, Key=obj[\\\"Key\\\"])\\n        break\\n\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} INFO (MyTransformOutputOneFileCsv) end\\\")\\n\",\"Inputs\":[\"node-1730279185825\"],\"Name\":\"【必須】１ファイルでb→dash向けDMバケットへ出力\"}},\"node-1735116474337\":{\"CustomCode\":{\"ClassName\":\"MyTransformOutputOneFileCsv_name\",\"Code\":\"from datetime import datetime\\nimport boto3\\nfrom awsglue.utils import getResolvedOptions\\nfrom pyspark.sql import DataFrame\\n\\n### 作成時の修正箇所ここから ###\\n#  本ノードは作成時のパラメータ設定不要です。このままお使いください。\\n### 作成時の修正箇所ここまで ###\\n\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} INFO (MyTransformOutputOneFileCsv) start\\\")\\n\\n# 関数定義\\ndef get_process_timestamp_from_df(df: DataFrame, column_name: str) -> str:\\n    \\\"\\\"\\\"DFからデータ統合基盤処理日時 文字列を取得する\\n    Args:\\n        df (pysoar.sql.DataFrame): データフレーム\\n        column_name (str): データ統合基盤処理日時項目名\\n    Returns:\\n        str: yyyymmddhhmmss\\n    \\\"\\\"\\\"\\n    # JSTタイムスタンプカラムの値を取得（yyyy/mm/dd hh:mm:ss形式）\\n    orion_process_datetm = df.select(column_name).first()[0]\\n    # yyyymmddhhmmss形式に変換\\n    res_datetm_str = datetime.strptime(orion_process_datetm, \\\"%Y/%m/%d %H:%M:%S\\\").strftime(\\\"%Y%m%d%H%M%S\\\")\\n    return res_datetm_str\\n\\n# Glueジョブ引数の取得\\nglue_params = getResolvedOptions(sys.argv, [\\\"SOURCE_SYSTEM\\\", \\\"DATA_NAME\\\"])\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (MyTransformOutputOneFileCsv) glue_params:{glue_params}\\\")\\n\\n# 連携元システム名（DMP/ONE/OCTPASS）\\nsource_system = glue_params.get(\\\"SOURCE_SYSTEM\\\", None)\\n# データ名（物理テーブル名）\\ndata_name = glue_params.get(\\\"DATA_NAME\\\", None)\\n\\n# プレフィックスヘッド\\nprefix_head = f\\\"{source_system}/{data_name}_name\\\"\\n\\n# DataFrameの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# ■実行日時をJSTのyyyyymmddhhmmss文字列に変換\\n# DFの処理日時項目名\\nORION_PROCESS_DATETM = \\\"orion_process_datetm\\\"\\nexecute_timestamp_str = get_process_timestamp_from_df(df=df, column_name=ORION_PROCESS_DATETM)\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (get_process_timestamp_from_df) execute_timestamp_str:{execute_timestamp_str}\\\")\\n\\n# 作業用バケット\\nwork_bucket = \\\"orion-prd-work\\\"\\n# workディレクトリ\\nwork_dir = f\\\"{prefix_head}/dwh_work2_{execute_timestamp_str}/\\\"\\n# 一時出力先s3パス\\nwork_s3_path = f\\\"s3://{work_bucket}/{work_dir}\\\"\\n\\n# workディレクトリにCSV形式で出力\\ndf.coalesce(1).write.options(encoding=\\\"UTF-8\\\", lineSep=\\\"\\\\n\\\", sep=\\\",\\\", quoteAll=True, header=True).mode(\\\"overwrite\\\").csv(work_s3_path)\\n\\n# DM_Bdashバケット\\ndm_bdash_bucket = \\\"orion-prd-dm-bdash\\\"\\n# 連携先ディレクトリ\\noutput_prefix = f\\\"{source_system}/{data_name}_name\\\"\\n# 連携ファイル名\\nfile_name = f\\\"octpass_single_item_detail_{execute_timestamp_str}_sta_name.csv\\\"\\n# 連携先key\\nfile_key = f\\\"{output_prefix}/{file_name}\\\"\\n\\n# S3クライアントを使用してworkフォルダに出力したファイルをリネームして移動\\ns3 = boto3.client(\\\"s3\\\")\\nresponse = s3.list_objects_v2(Bucket=work_bucket, Prefix=work_dir)\\nfor obj in response.get(\\\"Contents\\\", []):\\n    if obj[\\\"Key\\\"].endswith(\\\".csv\\\"):\\n        copy_source = {\\\"Bucket\\\": work_bucket, \\\"Key\\\": obj[\\\"Key\\\"]}\\n        print(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} DEBUG (MyTransformOutputOneFileCsv) copy_source:{copy_source}, dm_bdash_bucket:{dm_bdash_bucket}, file_key:{file_key}\\\")\\n        s3.copy_object(CopySource=copy_source, Bucket=dm_bdash_bucket, Key=file_key)\\n        s3.delete_object(Bucket=work_bucket, Key=obj[\\\"Key\\\"])\\n        break\\n\\nprint(f\\\"{datetime.strftime(datetime.now(), '%Y/%m/%dT%H:%M:%S')} INFO (MyTransformOutputOneFileCsv) end\\\")\\n\",\"Inputs\":[\"node-1735116447847\"],\"Name\":\"【必須】１ファイルでb→dash向けDMバケットへ出力（駅名）\"}},\"node-1736915757100\":{\"CustomCode\":{\"ClassName\":\"readSourceFile\",\"Code\":\"import sys\\nimport boto3\\nfrom awsglue.utils import getResolvedOptions\\n\\n# 引数の取得\\nglue_params = getResolvedOptions(sys.argv, [\\\"SOURCE_SYSTEM\\\", \\\"DATA_NAME\\\", \\\"FILE_NAME\\\"])\\n\\n# 連携元システム名\\nsource_system = glue_params.get(\\\"SOURCE_SYSTEM\\\", None)\\n# データ名（物理テーブル名）\\ndata_name = glue_params.get(\\\"DATA_NAME\\\", None)\\n# ファイル名\\nfile_name = glue_params.get(\\\"FILE_NAME\\\", None)\\n\\n# S3クライアント\\ns3 = boto3.client('s3')\\n\\n# バケット関連定義\\nsource_bucket = \\\"orion-prd-work\\\"\\ntmp_dir = \\\"dwh_tmp\\\"\\nsource_key = f\\\"{source_system}/{data_name}/{tmp_dir}/{file_name}\\\"\\n\\n# 存在チェック\\ns3.head_object(Bucket=source_bucket, Key=source_key)\\n\\n# ファイル読み込み\\n# S3からデータを読み込む\\ndata_source = glueContext.create_dynamic_frame.from_options(\\n    's3', \\n    {'paths': [f\\\"s3://{source_bucket}/{source_key}\\\"]}, \\n    format='parquet', \\n    format_options={'compression': 'snappy'}\\n)\\n\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": data_source}, glueContext)\",\"Inputs\":[\"node-1727682543308\"],\"Name\":\"【必須】連携された匿名化済みデータの読み込み\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"seq_no\",\"Type\":\"string\"},{\"Name\":\"data\",\"Type\":\"string\"},{\"Name\":\"judgment\",\"Type\":\"string\"},{\"Name\":\"judgment_code\",\"Type\":\"string\"},{\"Name\":\"last_enty_area_code\",\"Type\":\"string\"},{\"Name\":\"last_enty_comp\",\"Type\":\"string\"},{\"Name\":\"last_enty_line\",\"Type\":\"string\"},{\"Name\":\"last_enty_sta_ord\",\"Type\":\"string\"},{\"Name\":\"last_enty_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"last_enty_date\",\"Type\":\"string\"},{\"Name\":\"last_enty_time\",\"Type\":\"string\"},{\"Name\":\"last_exit_area_code\",\"Type\":\"string\"},{\"Name\":\"last_exit_comp\",\"Type\":\"string\"},{\"Name\":\"last_exit_line\",\"Type\":\"string\"},{\"Name\":\"last_exit_sta_ord\",\"Type\":\"string\"},{\"Name\":\"last_exit_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"last_exit_gate\",\"Type\":\"string\"},{\"Name\":\"last_exit_gate_no\",\"Type\":\"string\"},{\"Name\":\"last_exit_date\",\"Type\":\"string\"},{\"Name\":\"last_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_area_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_comp\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_line\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_sta_ord\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_area_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_comp\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_line\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_sta_ord\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_usage\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_area_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_comp\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_line\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_sta_ord\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_area_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_comp\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_line\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_sta_ord\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_usage\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_area_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_comp\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_line\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_sta_ord\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_after_usage\",\"Type\":\"string\"},{\"Name\":\"deduction\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_idi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_idi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_idi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via1_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via1_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via1_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via2_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via2_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via2_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via3_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via3_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via3_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via4_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via4_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via4_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via5_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via5_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via5_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via6_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via6_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via6_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via7_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via7_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via7_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via8_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via8_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via8_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via9_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via9_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via9_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via10_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via10_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_via10_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_free_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_free_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_free_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer2_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_idi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via1_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via1_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via1_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via2_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via2_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via2_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via3_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via3_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via3_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via4_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via4_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via4_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via5_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via5_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via5_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via6_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via6_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via6_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via7_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via7_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via7_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via8_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via8_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via8_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via9_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via9_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via9_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via10_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via10_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_via10_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_free_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_free_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_free_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer3_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_idi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_area_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_line\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_sta_ord\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_2nd_section\",\"Type\":\"string\"},{\"Name\":\"correction_fg\",\"Type\":\"string\"},{\"Name\":\"ictype\",\"Type\":\"string\"},{\"Name\":\"mobile_fg\",\"Type\":\"string\"},{\"Name\":\"is_valid_sub_pass\",\"Type\":\"string\"},{\"Name\":\"is_oerpass\",\"Type\":\"string\"},{\"Name\":\"orion_process_datetm\",\"Type\":\"string\"}]}]}},\"node-1736918028238\":{\"CustomCode\":{\"ClassName\":\"deleteSourceFile\",\"Code\":\"import sys\\nimport boto3\\nfrom awsglue.utils import getResolvedOptions\\n\\n# 引数の取得\\nglue_params = getResolvedOptions(sys.argv, [\\\"SOURCE_SYSTEM\\\", \\\"DATA_NAME\\\", \\\"FILE_NAME\\\"])\\n\\n# 連携元システム名\\nsource_system = glue_params.get(\\\"SOURCE_SYSTEM\\\", None)\\n# データ名（物理テーブル名）\\ndata_name = glue_params.get(\\\"DATA_NAME\\\", None)\\n# ファイル名\\nfile_name = glue_params.get(\\\"FILE_NAME\\\", None)\\n\\n# S3クライアント作成\\ns3 = boto3.client('s3')\\n\\n# バケット関連定義\\nsource_bucket = \\\"orion-prd-work\\\"\\ntmp_dir = \\\"dwh_tmp\\\"\\nsource_key = f\\\"{source_system}/{data_name}/{tmp_dir}/{file_name}\\\"\\n\\n# 存在チェック\\ns3.head_object(Bucket=source_bucket, Key=source_key)\\n\\n# ファイル削除\\ns3.delete_object(Bucket=source_bucket, Key=source_key)\\n\",\"Inputs\":[\"node-1735116474337\"],\"Name\":\"【必須】処理用一時ディレクトリのファイルの削除\"}},\"node-1735115376657\":{\"CustomCode\":{\"ClassName\":\"MyTransform_this_station_name\",\"Code\":\"from pyspark.sql.functions import col, lit, when\\nfrom awsglue.dynamicframe import DynamicFrame\\nimport boto3\\nimport pyarrow.parquet as pq\\nimport s3fs\\nfrom pyspark.sql import SparkSession\\nfrom pyspark.sql.functions import broadcast\\n\\n# S3パスとマスターデータの設定\\ns3_path = \\\"s3://orion-prd-dwh/MANUAL/stations_master/latest/\\\"\\nmaster_file_prefix = \\\"stations_master_dwh_\\\"\\nmaster_key = \\\"od_mst_sta_code\\\"\\nmaster_value = \\\"sta_name\\\"\\n\\n# 千代田線直通を判断させるため\\n# OD駅コードから駅名を設定する。\\n# \\n# 入力項目名リストの設定\\ninput_column_list = [\\n    \\\"this_oer_enty_od_sta_code\\\",\\\"this_oer_exit_od_sta_code\\\",\\n    ]\\noutput_column_list = [\\n    \\\"this_oer_enty_sta_name\\\",\\\"this_oer_exit_sta_name\\\",\\n    ]\\n\\n# S3からマスターデータを読み込む\\ns3 = s3fs.S3FileSystem()\\nfiles = s3.glob(s3_path + master_file_prefix + \\\"*.parquet\\\")\\nmaster_df = None\\nfor file in files:\\n    with s3.open(file, 'rb') as f:\\n        if master_df is None:\\n            master_df = pq.read_table(f).to_pandas()\\n        else:\\n            master_df = master_df.append(pq.read_table(f).to_pandas())\\n\\n# Spark DataFrameに変換\\nspark = SparkSession.builder.getOrCreate()\\nmaster_spark_df = spark.createDataFrame(master_df)\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# orion_process_datetm 列を保持するためのバックアップ\\ndf = df.withColumn(\\\"orion_process_datetm_backup\\\", col(\\\"orion_process_datetm\\\"))\\n\\n# 入力項目名リストの処理\\nfor i, input_col in enumerate(input_column_list):\\n    output_col = output_column_list[i]\\n    df = df.alias(\\\"df\\\").join(broadcast(master_spark_df.alias(\\\"master\\\")), col(f\\\"df.{input_col}\\\") == col(f\\\"master.{master_key}\\\"), \\\"left_outer\\\") \\\\\\n           .withColumn(output_col, when(col(f\\\"master.{master_value}\\\").isNotNull(), col(f\\\"master.{master_value}\\\")).otherwise(lit(\\\"\\\"))) \\\\\\n           .drop(col(f\\\"master.{master_key}\\\")) \\\\\\n           .drop(col(f\\\"master.{master_value}\\\"))\\n\\n# orion_process_datetm 列を元に戻す\\ndf = df.withColumn(\\\"orion_process_datetm\\\", col(\\\"orion_process_datetm_backup\\\")).drop(\\\"orion_process_datetm_backup\\\")\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\",\"Inputs\":[\"node-1735115126915\"],\"Name\":\"【加工】今回駅名設定\"}},\"node-1733378552816\":{\"CustomCode\":{\"ClassName\":\"MyTransform_Delete_column\",\"Code\":\"from awsglue.dynamicframe import DynamicFrame\\nfrom pyspark.sql.functions import col\\n\\n### 作成時の修正箇所ここから ###\\n# 削除項目名の設定\\n削除項目名リスト = [\\n    \\\"last_enty_area_code\\\",\\\"last_enty_comp\\\",\\\"last_enty_line\\\",\\\"last_enty_sta_ord\\\",\\\"last_enty_orion_sta_code\\\",\\\"last_enty_date\\\",\\\"last_enty_time\\\",\\\"last_exit_area_code\\\",\\\"last_exit_comp\\\",\\\"last_exit_line\\\",\\\"last_exit_sta_ord\\\",\\\"last_exit_orion_sta_code\\\",\\\"last_exit_gate\\\",\\\"last_exit_gate_no\\\",\\\"last_exit_date\\\",\\\"last_exit_time\\\",\\\"this_bef_enty_area_code\\\",\\\"this_bef_enty_comp\\\",\\\"this_bef_enty_line\\\",\\\"this_bef_enty_sta_ord\\\",\\\"this_bef_exit_area_code\\\",\\\"this_bef_exit_comp\\\",\\\"this_bef_exit_line\\\",\\\"this_bef_exit_sta_ord\\\",\\\"this_oer_enty_area_code\\\",\\\"this_oer_enty_comp\\\",\\\"this_oer_enty_line\\\",\\\"this_oer_enty_sta_ord\\\",\\\"this_oer_exit_area_code\\\",\\\"this_oer_exit_comp\\\",\\\"this_oer_exit_line\\\",\\\"this_oer_exit_sta_ord\\\",\\\"this_after_enty_area_code\\\",\\\"this_after_enty_comp\\\",\\\"this_after_enty_line\\\",\\\"this_after_enty_sta_ord\\\",\\\"orig_tick_bef_ticket_type\\\",\\\"orig_tick_bef_idi\\\",\\\"orig_tick_bef_child_fg\\\",\\\"orig_tick_bef_area_code\\\",\\\"orig_tick_bef_u_code\\\",\\\"orig_tick_bef_age\\\",\\\"orig_tick_bef_sex\\\",\\\"orig_tick_bef_charge_fg\\\",\\\"orig_tick_bef_inbound\\\",\\\"orig_tick_bef_sta_date\\\",\\\"orig_tick_bef_end_date\\\",\\\"orig_tick_bef_sta_station_line\\\",\\\"orig_tick_bef_sta_station_sta_ord\\\",\\\"orig_tick_bef_sta_station_area_code\\\",\\\"orig_tick_bef_sta_orion_sta_code\\\",\\\"orig_tick_bef_sta_station_w_no\\\",\\\"orig_tick_bef_end_station_line\\\",\\\"orig_tick_bef_end_station_sta_ord\\\",\\\"orig_tick_bef_end_station_area_code\\\",\\\"orig_tick_bef_end_orion_sta_code\\\",\\\"orig_tick_bef_end_station_w_no\\\",\\\"orig_tick_bef_via1_line\\\",\\\"orig_tick_bef_via1_sta_ord\\\",\\\"orig_tick_bef_via1_orion_sta_code\\\",\\\"orig_tick_bef_via2_line\\\",\\\"orig_tick_bef_via2_sta_ord\\\",\\\"orig_tick_bef_via2_orion_sta_code\\\",\\\"orig_tick_bef_via3_line\\\",\\\"orig_tick_bef_via3_sta_ord\\\",\\\"orig_tick_bef_via3_orion_sta_code\\\",\\\"orig_tick_bef_via4_line\\\",\\\"orig_tick_bef_via4_sta_ord\\\",\\\"orig_tick_bef_via4_orion_sta_code\\\",\\\"orig_tick_bef_via5_line\\\",\\\"orig_tick_bef_via5_sta_ord\\\",\\\"orig_tick_bef_via5_orion_sta_code\\\",\\\"orig_tick_bef_via6_line\\\",\\\"orig_tick_bef_via6_sta_ord\\\",\\\"orig_tick_bef_via6_orion_sta_code\\\",\\\"orig_tick_bef_via7_line\\\",\\\"orig_tick_bef_via7_sta_ord\\\",\\\"orig_tick_bef_via7_orion_sta_code\\\",\\\"orig_tick_bef_via8_line\\\",\\\"orig_tick_bef_via8_sta_ord\\\",\\\"orig_tick_bef_via8_orion_sta_code\\\",\\\"orig_tick_bef_via9_line\\\",\\\"orig_tick_bef_via9_sta_ord\\\",\\\"orig_tick_bef_via9_orion_sta_code\\\",\\\"orig_tick_bef_via10_line\\\",\\\"orig_tick_bef_via10_sta_ord\\\",\\\"orig_tick_bef_via10_orion_sta_code\\\",\\\"orig_tick_bef_free_line\\\",\\\"orig_tick_bef_free_sta_ord\\\",\\\"orig_tick_bef_free_orion_sta_code\\\",\\\"orig_tick_bef_com_school\\\",\\\"orig_tick_bef_discount\\\",\\\"orig_tick_bef_2nd_section\\\",\\\"orig_tick_oer1_area_code\\\",\\\"orig_tick_oer1_sta_station_line\\\",\\\"orig_tick_oer1_sta_station_sta_ord\\\",\\\"orig_tick_oer1_sta_station_area_code\\\",\\\"orig_tick_oer1_end_station_line\\\",\\\"orig_tick_oer1_end_station_sta_ord\\\",\\\"orig_tick_oer1_end_station_area_code\\\",\\\"orig_tick_oer1_via1_line\\\",\\\"orig_tick_oer1_via1_sta_ord\\\",\\\"orig_tick_oer1_via2_line\\\",\\\"orig_tick_oer1_via2_sta_ord\\\",\\\"orig_tick_oer1_via3_line\\\",\\\"orig_tick_oer1_via3_sta_ord\\\",\\\"orig_tick_oer1_via4_line\\\",\\\"orig_tick_oer1_via4_sta_ord\\\",\\\"orig_tick_oer1_via5_line\\\",\\\"orig_tick_oer1_via5_sta_ord\\\",\\\"orig_tick_oer1_via6_line\\\",\\\"orig_tick_oer1_via6_sta_ord\\\",\\\"orig_tick_oer1_via7_line\\\",\\\"orig_tick_oer1_via7_sta_ord\\\",\\\"orig_tick_oer1_via8_line\\\",\\\"orig_tick_oer1_via8_sta_ord\\\",\\\"orig_tick_oer1_via9_line\\\",\\\"orig_tick_oer1_via9_sta_ord\\\",\\\"orig_tick_oer1_via10_line\\\",\\\"orig_tick_oer1_via10_sta_ord\\\",\\\"orig_tick_oer1_free_line\\\",\\\"orig_tick_oer1_free_sta_ord\\\",\\\"orig_tick_oer2_ticket_type\\\",\\\"orig_tick_oer2_idi\\\",\\\"orig_tick_oer2_child_fg\\\",\\\"orig_tick_oer2_area_code\\\",\\\"orig_tick_oer2_u_code\\\",\\\"orig_tick_oer2_age\\\",\\\"orig_tick_oer2_sex\\\",\\\"orig_tick_oer2_charge_fg\\\",\\\"orig_tick_oer2_inbound\\\",\\\"orig_tick_oer2_sta_date\\\",\\\"orig_tick_oer2_end_date\\\",\\\"orig_tick_oer2_sta_station_line\\\",\\\"orig_tick_oer2_sta_station_sta_ord\\\",\\\"orig_tick_oer2_sta_station_area_code\\\",\\\"orig_tick_oer2_sta_orion_sta_code\\\",\\\"orig_tick_oer2_sta_station_w_no\\\",\\\"orig_tick_oer2_end_station_line\\\",\\\"orig_tick_oer2_end_station_sta_ord\\\",\\\"orig_tick_oer2_end_station_area_code\\\",\\\"orig_tick_oer2_end_orion_sta_code\\\",\\\"orig_tick_oer2_end_station_w_no\\\",\\\"orig_tick_oer2_via1_line\\\",\\\"orig_tick_oer2_via1_sta_ord\\\",\\\"orig_tick_oer2_via1_orion_sta_code\\\",\\\"orig_tick_oer2_via2_line\\\",\\\"orig_tick_oer2_via2_sta_ord\\\",\\\"orig_tick_oer2_via2_orion_sta_code\\\",\\\"orig_tick_oer2_via3_line\\\",\\\"orig_tick_oer2_via3_sta_ord\\\",\\\"orig_tick_oer2_via3_orion_sta_code\\\",\\\"orig_tick_oer2_via4_line\\\",\\\"orig_tick_oer2_via4_sta_ord\\\",\\\"orig_tick_oer2_via4_orion_sta_code\\\",\\\"orig_tick_oer2_via5_line\\\",\\\"orig_tick_oer2_via5_sta_ord\\\",\\\"orig_tick_oer2_via5_orion_sta_code\\\",\\\"orig_tick_oer2_via6_line\\\",\\\"orig_tick_oer2_via6_sta_ord\\\",\\\"orig_tick_oer2_via6_orion_sta_code\\\",\\\"orig_tick_oer2_via7_line\\\",\\\"orig_tick_oer2_via7_sta_ord\\\",\\\"orig_tick_oer2_via7_orion_sta_code\\\",\\\"orig_tick_oer2_via8_line\\\",\\\"orig_tick_oer2_via8_sta_ord\\\",\\\"orig_tick_oer2_via8_orion_sta_code\\\",\\\"orig_tick_oer2_via9_line\\\",\\\"orig_tick_oer2_via9_sta_ord\\\",\\\"orig_tick_oer2_via9_orion_sta_code\\\",\\\"orig_tick_oer2_via10_line\\\",\\\"orig_tick_oer2_via10_sta_ord\\\",\\\"orig_tick_oer2_via10_orion_sta_code\\\",\\\"orig_tick_oer2_free_line\\\",\\\"orig_tick_oer2_free_sta_ord\\\",\\\"orig_tick_oer2_free_orion_sta_code\\\",\\\"orig_tick_oer2_com_school\\\",\\\"orig_tick_oer2_discount\\\",\\\"orig_tick_oer2_2nd_section\\\",\\\"orig_tick_oer3_ticket_type\\\",\\\"orig_tick_oer3_idi\\\",\\\"orig_tick_oer3_child_fg\\\",\\\"orig_tick_oer3_area_code\\\",\\\"orig_tick_oer3_u_code\\\",\\\"orig_tick_oer3_age\\\",\\\"orig_tick_oer3_sex\\\",\\\"orig_tick_oer3_charge_fg\\\",\\\"orig_tick_oer3_inbound\\\",\\\"orig_tick_oer3_sta_date\\\",\\\"orig_tick_oer3_end_date\\\",\\\"orig_tick_oer3_sta_station_line\\\",\\\"orig_tick_oer3_sta_station_sta_ord\\\",\\\"orig_tick_oer3_sta_station_area_code\\\",\\\"orig_tick_oer3_sta_orion_sta_code\\\",\\\"orig_tick_oer3_sta_station_w_no\\\",\\\"orig_tick_oer3_end_station_line\\\",\\\"orig_tick_oer3_end_station_sta_ord\\\",\\\"orig_tick_oer3_end_station_area_code\\\",\\\"orig_tick_oer3_end_orion_sta_code\\\",\\\"orig_tick_oer3_end_station_w_no\\\",\\\"orig_tick_oer3_via1_line\\\",\\\"orig_tick_oer3_via1_sta_ord\\\",\\\"orig_tick_oer3_via1_orion_sta_code\\\",\\\"orig_tick_oer3_via2_line\\\",\\\"orig_tick_oer3_via2_sta_ord\\\",\\\"orig_tick_oer3_via2_orion_sta_code\\\",\\\"orig_tick_oer3_via3_line\\\",\\\"orig_tick_oer3_via3_sta_ord\\\",\\\"orig_tick_oer3_via3_orion_sta_code\\\",\\\"orig_tick_oer3_via4_line\\\",\\\"orig_tick_oer3_via4_sta_ord\\\",\\\"orig_tick_oer3_via4_orion_sta_code\\\",\\\"orig_tick_oer3_via5_line\\\",\\\"orig_tick_oer3_via5_sta_ord\\\",\\\"orig_tick_oer3_via5_orion_sta_code\\\",\\\"orig_tick_oer3_via6_line\\\",\\\"orig_tick_oer3_via6_sta_ord\\\",\\\"orig_tick_oer3_via6_orion_sta_code\\\",\\\"orig_tick_oer3_via7_line\\\",\\\"orig_tick_oer3_via7_sta_ord\\\",\\\"orig_tick_oer3_via7_orion_sta_code\\\",\\\"orig_tick_oer3_via8_line\\\",\\\"orig_tick_oer3_via8_sta_ord\\\",\\\"orig_tick_oer3_via8_orion_sta_code\\\",\\\"orig_tick_oer3_via9_line\\\",\\\"orig_tick_oer3_via9_sta_ord\\\",\\\"orig_tick_oer3_via9_orion_sta_code\\\",\\\"orig_tick_oer3_via10_line\\\",\\\"orig_tick_oer3_via10_sta_ord\\\",\\\"orig_tick_oer3_via10_orion_sta_code\\\",\\\"orig_tick_oer3_free_line\\\",\\\"orig_tick_oer3_free_sta_ord\\\",\\\"orig_tick_oer3_free_orion_sta_code\\\",\\\"orig_tick_oer3_com_school\\\",\\\"orig_tick_oer3_discount\\\",\\\"orig_tick_oer3_2nd_section\\\",\\\"orig_tick_after_ticket_type\\\",\\\"orig_tick_after_idi\\\",\\\"orig_tick_after_child_fg\\\",\\\"orig_tick_after_area_code\\\",\\\"orig_tick_after_u_code\\\",\\\"orig_tick_after_age\\\",\\\"orig_tick_after_sex\\\",\\\"orig_tick_after_charge_fg\\\",\\\"orig_tick_after_inbound\\\",\\\"orig_tick_after_sta_date\\\",\\\"orig_tick_after_end_date\\\",\\\"orig_tick_after_sta_station_line\\\",\\\"orig_tick_after_sta_station_sta_ord\\\",\\\"orig_tick_after_sta_station_area_code\\\",\\\"orig_tick_after_sta_orion_sta_code\\\",\\\"orig_tick_after_sta_station_w_no\\\",\\\"orig_tick_after_end_station_line\\\",\\\"orig_tick_after_end_station_sta_ord\\\",\\\"orig_tick_after_end_station_area_code\\\",\\\"orig_tick_after_end_orion_sta_code\\\",\\\"orig_tick_after_end_station_w_no\\\",\\\"orig_tick_after_via1_line\\\",\\\"orig_tick_after_via1_sta_ord\\\",\\\"orig_tick_after_via1_orion_sta_code\\\",\\\"orig_tick_after_via2_line\\\",\\\"orig_tick_after_via2_sta_ord\\\",\\\"orig_tick_after_via2_orion_sta_code\\\",\\\"orig_tick_after_via3_line\\\",\\\"orig_tick_after_via3_sta_ord\\\",\\\"orig_tick_after_via3_orion_sta_code\\\",\\\"orig_tick_after_via4_line\\\",\\\"orig_tick_after_via4_sta_ord\\\",\\\"orig_tick_after_via4_orion_sta_code\\\",\\\"orig_tick_after_via5_line\\\",\\\"orig_tick_after_via5_sta_ord\\\",\\\"orig_tick_after_via5_orion_sta_code\\\",\\\"orig_tick_after_via6_line\\\",\\\"orig_tick_after_via6_sta_ord\\\",\\\"orig_tick_after_via6_orion_sta_code\\\",\\\"orig_tick_after_via7_line\\\",\\\"orig_tick_after_via7_sta_ord\\\",\\\"orig_tick_after_via7_orion_sta_code\\\",\\\"orig_tick_after_via8_line\\\",\\\"orig_tick_after_via8_sta_ord\\\",\\\"orig_tick_after_via8_orion_sta_code\\\",\\\"orig_tick_after_via9_line\\\",\\\"orig_tick_after_via9_sta_ord\\\",\\\"orig_tick_after_via9_orion_sta_code\\\",\\\"orig_tick_after_via10_line\\\",\\\"orig_tick_after_via10_sta_ord\\\",\\\"orig_tick_after_via10_orion_sta_code\\\",\\\"orig_tick_after_free_line\\\",\\\"orig_tick_after_free_sta_ord\\\",\\\"orig_tick_after_free_orion_sta_code\\\",\\\"orig_tick_after_com_school\\\",\\\"orig_tick_after_discount\\\",\\\"orig_tick_after_2nd_section\\\",\\n        ]\\n### 作成時の修正箇所ここまで ###\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# 不要なカラムを削除\\nfor 削除項目名 in 削除項目名リスト:\\n    df = df.drop(col(削除項目名))\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1736917015955\"],\"Name\":\"【加工】非連携項目の削除\",\"OutputSchemas\":[{\"Columns\":[]}]}},\"node-1733302977291\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1733302891155\"],\"Name\":\"【加工後必須】上原直通OD変更\"}},\"node-1735116447847\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735116384834\"],\"Name\":\"【加工済必須】項目順序の並替え（駅名）\"}},\"node-1735282308232\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735281571512\"],\"Name\":\"【加工後必須】コーナー名\"}},\"node-1735115478379\":{\"CustomCode\":{\"ClassName\":\"MyTransformm_dm_dm_ticket_type\",\"Code\":\"from pyspark.sql.functions import col, when\\nfrom awsglue.dynamicframe import DynamicFrame\\n\\n# データフレームの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# this_oer_dm_ticket_typeの初期化\\ndf = df.withColumn(\\\"this_oer_dm_ticket_type\\\", when(col(\\\"this_oer_usage\\\").isin([0, 3, 4, 5, 6]), \\\"定期\\\")\\n                                                .when(col(\\\"this_oer_usage\\\").isin([1, 2]), \\\"定期外\\\")\\n                                                .otherwise(None))\\n\\n# orig_tick_oer1_ticket_typeに基づく条件\\ndf = df.withColumn(\\\"this_oer_dm_ticket_type\\\", when((col(\\\"this_oer_dm_ticket_type\\\").isNull()) & \\n                                                   col(\\\"orig_tick_oer1_ticket_type\\\").isin([2, 61, 62, 63, 64, 65]), \\\"定期\\\")\\n                                                .when((col(\\\"this_oer_dm_ticket_type\\\").isNull()), \\\"定期外\\\")\\n                                                .otherwise(col(\\\"this_oer_dm_ticket_type\\\")))\\n\\n# 通学定期と通勤定期の設定\\ndf = df.withColumn(\\\"this_oer_dm_ticket_type\\\", when((col(\\\"this_oer_dm_ticket_type\\\") == \\\"定期\\\") & \\n                                                   (col(\\\"orig_tick_oer1_com_school\\\") == 1), \\\"通学定期\\\")\\n                                                .when((col(\\\"this_oer_dm_ticket_type\\\") == \\\"定期\\\"), \\\"通勤定期\\\")\\n                                                .otherwise(col(\\\"this_oer_dm_ticket_type\\\")))\\n\\n# DynamicFrameに変換\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1735282308232\"],\"Name\":\"【加工】今回DM券種設定\"}},\"node-1727682543308\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://orion-prd-work/OCTPASS/past_octpass_single_item_detail/schema/past_octpass_single_item_detail_schema.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Name\":\"【必須】連携された正則化済データ\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[]}],\"Paths\":[\"s3://orion-prd-work/OCTPASS/past_octpass_single_item_detail/schema/\"],\"QuoteChar\":\"quote\",\"Separator\":\"comma\",\"WithHeader\":true}},\"node-1735282090189\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735281843676\"],\"Name\":\"【加工後必須】コーナーコード（生成）\"}},\"node-1730279130441\":{\"CustomCode\":{\"ClassName\":\"MyTransformSortFeilds\",\"Code\":\"from awsglue.dynamicframe import DynamicFrame, DynamicFrameCollection\\n\\n### 作成時の修正箇所ここから ###\\n# 並び替えたい順序で全項目名を記載する\\n項目順序 = [\\n    \\\"seq_no\\\",\\\"data\\\",\\\"judgment\\\",\\\"judgment_code\\\",\\\"this_bef_enty_orion_sta_code\\\",\\\"this_bef_enty_date\\\",\\\"this_bef_enty_time\\\",\\\"this_bef_exit_orion_sta_code\\\",\\\"this_bef_exit_date\\\",\\\"this_bef_exit_time\\\",\\\"this_bef_usage\\\",\\\"this_oer_enty_orion_sta_code\\\",\\\"this_oer_enty_od_sta_code\\\",\\\"this_oer_enty_gate\\\",\\\"this_oer_enty_gate_no\\\",\\\"this_oer_enty_date\\\",\\\"this_oer_enty_time\\\",\\\"this_oer_exit_orion_sta_code\\\",\\\"this_oer_exit_od_sta_code\\\",\\\"this_oer_exit_gate\\\",\\\"this_oer_exit_gate_no\\\",\\\"this_oer_exit_date\\\",\\\"this_oer_exit_time\\\",\\\"this_oer_usage\\\",\\\"this_after_enty_orion_sta_code\\\",\\\"this_after_enty_date\\\",\\\"this_after_enty_time\\\",\\\"this_after_usage\\\",\\\"deduction\\\",\\\"orig_tick_oer1_ticket_type\\\",\\\"orig_tick_oer1_idi\\\",\\\"orig_tick_oer1_child_fg\\\",\\\"orig_tick_oer1_u_code\\\",\\\"orig_tick_oer1_age\\\",\\\"orig_tick_oer1_sex\\\",\\\"orig_tick_oer1_charge_fg\\\",\\\"orig_tick_oer1_inbound\\\",\\\"orig_tick_oer1_sta_date\\\",\\\"orig_tick_oer1_end_date\\\",\\\"orig_tick_oer1_sta_orion_sta_code\\\",\\\"orig_tick_oer1_sta_station_w_no\\\",\\\"orig_tick_oer1_end_orion_sta_code\\\",\\\"orig_tick_oer1_end_station_w_no\\\",\\\"orig_tick_oer1_via1_orion_sta_code\\\",\\\"orig_tick_oer1_via2_orion_sta_code\\\",\\\"orig_tick_oer1_via3_orion_sta_code\\\",\\\"orig_tick_oer1_via4_orion_sta_code\\\",\\\"orig_tick_oer1_via5_orion_sta_code\\\",\\\"orig_tick_oer1_via6_orion_sta_code\\\",\\\"orig_tick_oer1_via7_orion_sta_code\\\",\\\"orig_tick_oer1_via8_orion_sta_code\\\",\\\"orig_tick_oer1_via9_orion_sta_code\\\",\\\"orig_tick_oer1_via10_orion_sta_code\\\",\\\"orig_tick_oer1_free_orion_sta_code\\\",\\\"orig_tick_oer1_com_school\\\",\\\"orig_tick_oer1_discount\\\",\\\"orig_tick_oer1_2nd_section\\\",\\\"correction_fg\\\",\\\"ictype\\\",\\\"mobile_fg\\\",\\\"is_valid_sub_pass\\\",\\\"is_oerpass\\\",\\\"orion_process_datetm\\\",\\n        ]\\n### 作成時の修正箇所ここまで ###\\n\\n# DataFrameの取得\\ndf = dfc.select(list(dfc.keys())[0]).toDF()\\n\\n# 指定した順序でDataFrameのカラムを並び替え\\ndf = df.select(項目順序)\\n\\n# DynamicFrameに変換して返す\\noutput_dyf = DynamicFrame.fromDF(df, glueContext, \\\"output\\\")\\nreturn DynamicFrameCollection({\\\"CustomTransform0\\\": output_dyf}, glueContext)\\n\",\"Inputs\":[\"node-1733302977291\"],\"Name\":\"【加工】項目順序の並替え\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"Judgment_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_bef_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_bef_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_bef_usage\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_gate_no\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_date\",\"Type\":\"string\"},{\"Name\":\"this_oer_exit_time\",\"Type\":\"string\"},{\"Name\":\"this_oer_usage\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_od_sta_code\",\"Type\":\"string\"},{\"Name\":\"this_after_enty_date\",\"Type\":\"null\"},{\"Name\":\"this_after_enty_time\",\"Type\":\"string\"},{\"Name\":\"this_after_usage\",\"Type\":\"string\"},{\"Name\":\"deduction\",\"Type\":\"int\"},{\"Name\":\"orig_tick_bef_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_bef_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_bef_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_date\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_oer1_2nd_section\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_ticket_type\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_IDi\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_child_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_u_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_age\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sex\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_charge_fg\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_Inbound\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_end_date\",\"Type\":\"null\"},{\"Name\":\"orig_tick_after_sta_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_sta_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_end_station_w_no\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via1_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via2_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via3_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via4_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via5_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via6_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via7_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via8_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via9_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_via10_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_free_Orion_sta_code\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_com_school\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_discount\",\"Type\":\"string\"},{\"Name\":\"orig_tick_after_2nd_section\",\"Type\":\"string\"},{\"Name\":\"correction_fg\",\"Type\":\"string\"},{\"Name\":\"ictype\",\"Type\":\"string\"},{\"Name\":\"mobile_fg\",\"Type\":\"string\"},{\"Name\":\"is_valid_sub_pass\",\"Type\":\"string\"},{\"Name\":\"is_oerpass\",\"Type\":\"string\"},{\"Name\":\"orion_process_datetm\",\"Type\":\"string\"}]}]}},\"node-1735115126915\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1735115042302\"],\"Name\":\"【加工済必須】駅名設定\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "ORioN_nonPIA",
    "branch" : "master",
    "folder" : "main"
  }
}